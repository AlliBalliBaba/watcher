#!/usr/bin/env ruby
# frozen_string_literal: true

require "watcher"

if ARGV.empty?
  puts("Usage: watcher <path>")
  exit(1)
end

path = ARGV[0]
watcher = Watcher::Watch.new(path, method(:puts))
ObjectSpace.define_finalizer(watcher, Watcher::Watch.method(:finalize).to_proc)
puts("Watching #{path}. Press Enter to stop.")
gets
